<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!--CSS ESTILOS BOOTSTRAP-->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
<link rel="stylesheet" href="./css/bootstrap.css">
<link rel="stylesheet" href="./css/bootstrap-theme.css">
<link rel="stylesheet" href="./css/bootstrapValidator.css">
<link rel="stylesheet" href="./css/estilosUsuario.css">
<link rel="" href="./css/bootstrap-utilities.css">
<link rel="" href="./css/bootstrap-utilities.min.css">
<link rel="stylesheet" href="./fonts/all.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=Chau+Philomene+One&family=Raleway:wght@500&family=Secular+One&display=swap"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
	integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
	crossorigin="anonymous" referrerpolicy="no-referrer" />

<!--CSS ESTILOS-->
<link rel="stylesheet" href="./css/cssCarousel.css">


<title>Carrito de compras</title>
</head>
<body class="d-flex flex-column pagUsuario">

	<%@ include file="snippets/headerIndexUser.jsp"%>

	<main>
		<c:choose>

			<c:when
				test="${cliente == null || nomUsuario.getIdTipoUsuario() == 1 }">

				<div
					class="container d-flex flex-column p-0 text-center bg-white p-2 m-auto rounded-3  shadow mb-4"
					style="max-width: 824px; border: 2px solid #FABE27">

					<div class="w-50 m-auto p-4">
						<i class="fa-solid fa-circle-exclamation text-danger"
							style="font-size: 80px"></i>
						<h1 class="titulo h2 text-uppercase">${ nomUsuario.getIdTipoUsuario() == 1 ? "No tienes los permisos de cliente para realizar una compra" : "Sesión no iniciada" }</h1>

					</div>

					<c:choose>
						<c:when test="${ nomUsuario.getIdTipoUsuario() == 1 }">
							<div class="w-50 m-auto p-2">
								<h4>Debes de iniciar sesión como cliente.</h4>
							</div>
						</c:when>

						<c:otherwise>
							<div class="w-50 m-auto p-2">
								<h4>Para realizar una compra deberá tener una cuenta.</h4>

								<div class="d-flex justify-content-around">
									<a href="login.jsp" class="btn btnMenu">Iniciar Sesión</a> <a
										href="Cliente.jsp" class="btn btnMenu">Registrarse</a>
								</div>
							</div>
						</c:otherwise>
					</c:choose>

					<div class="d-flex flex-end	justify-content-end align-items-end">

						<p class="m-0 px-2 fw-normal">¿Desea regresar al inicio?</p>
						<a href="indexUser.jsp" class="text-decoration-none">Regresar</a>

					</div>


				</div>

			</c:when>
			<c:otherwise>
				<div class="container">
					<h1>Carrito de compras</h1>
					<hr>
					<div class="row" id="cards">

						<!--Aquí se muestra la información de las compras-->
						<table class="table">
							<thead>
								<tr>
									<th scope="col" class="nombreProducto">Agrega tu producto
										aquí</th>
									<th scope="col"></th>
									<th scope="col">Nombre de Producto</th>
									<th scope="col">Precio</th>
									<th scope="col">Cantidad</th>
									<th scope="col">Pedir</th>
									<th scope="col">Total</th>
								</tr>
							</thead>
							<!--Tengo que acceder aquí para comprar-->
							<tbody id="items">

								<c:forEach var="DetaPedido" items="${listProducto}">

									<tr>
										<input type="hidden" id="id" name="id"
											value="${DetaPedido.getProduct().getCodProd()} ${DetaPedido.getPromo().getCodPromo()} ">
										<input type="hidden" id="object" name="object"
											value="${ DetaPedido.getProduct() == null ? 'promo' : 'producto'}">

										<td>${DetaPedido.getProduct().getCodProd()}
											${DetaPedido.getPromo().getCodPromo()}</td>

										<td>
										<c:if test="${DetaPedido.getCodProd() != 0}">
											<img 
											class="imagenCarro rounded shadow"
											alt="${DetaPedido.getProduct().getNomPro()}"
											src="./img/productos/${DetaPedido.getProduct().getImagenProd()}.png ">
											
										</c:if>
										<c:if test="${DetaPedido.getCodPromo() != 0}">
											<img 
											class="imagenCarro rounded shadow"
											alt="${DetaPedido.getPromo().getNomPromo()}"
											src="./img/promociones/${DetaPedido.getPromo().getImagenCombo()}.png ">
										</c:if>
										</td>

										<td>${DetaPedido.getProduct().getNomPro()}
											${DetaPedido.getPromo().getNomPromo()}</td>

										<td>${DetaPedido.getProduct().getPrecioPro()}
											${DetaPedido.getPromo().getPrecioPromo()}</td>

										<td>${DetaPedido.getCant()}</td>
										<td>
											<button class="btnAgregar btn btn-info btn-sm">+</button>
											<button class="btnDesminuir btn btn-danger btn-sm">-</button>
										</td>
										<td>${DetaPedido.getPrecioPedidoTot()}</td>
									</tr>
								</c:forEach>

							</tbody>

							
						</table>
						<button class="my-2 btn btnMenu w-25" id="CDP">Genera Comprobante de Pago</button>

					</div>
				</div>

			</c:otherwise>


		</c:choose>





	</main>

	<%@ include file="snippets/modal-template.jsp"%>
	<%@ include file="snippets/footerIndexUser.jsp"%>
</body>
<!--ESTILOS JS-->

<script type="text/javascript" src="./js/bootstrap.min.js"></script>
<script type="text/javascript" src="./js/bootstrapValidator.js"></script>
<script type="text/javascript" src="./js/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="./js/popper.min.js"></script>
<script type="text/javascript" src="./js/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="./js/bootstrap.bundle.min.js"></script>

<script type="module" src="./js/carrito.js"></script>



</html>